/* ==================================
   re-section.js - Monthly Retrospective Section
   ⚠️ 이 파일은 manager.py가 자동 생성합니다
   ================================== */

const isLocal = window.location.protocol === 'file:';

// Re section data - Generated by manager.py
const reData = [{"year": "2026", "items": [{"date": "2026.01", "title_kr": "2026년을 맞이하며", "title_en": "Welcoming 2026", "desc_kr": "정말 질기고 길게 느껴졌던 2025년이 저물고 비로소 올 것 같지 않던 너무나 멀게 느껴지던 2026년이 밝았다.<br>작년 1월 1일은 쓰라린 기억으로 남아있지만, 올해의 첫날은 그 아픔을 되새기며 차분히 잠을 청했다.<br><br>1월 2일이 되고 커피를 마시며 나의 캘린더를 슥슥 내려보았다. 2030년까지 빽빽한 Future 캘린더..<br>그 와중에도 2026년은 숨 가쁘게 흘러갈 것 같다. 아직 가보지 않은 길을 걷게 되는거라서 무섭기도 하고 설레기도 한 그런.. 느낌,,<br>그런데도 달라지지 않는건 내 캘린더는 이미 포화 상태다. 아니 이미 폭파 했을지도 모른다.<br>하고 싶은 건 넘치는데 몸은 하나라, 무엇보다 우선순위를 냉철하게 정해야 할 시점이라는걸 다시금 느끼곤 한다.<br><br>격변은 1월부터 시작될 듯하다. MIT 6.0001 과정을 마무리하고 6.0002를 시작하게 된다.<br>HND 연구는... 부디 초안이라도 완성되어 있기를<br>사실 아직 학부 입학도 하지 않은 내가 연구라는 것을 해도 되는 걸까, 라는 의문이 끊임없이 들곤 한다.<br>모르겠다. 그저 부디, 이 1월이 무탈하게 잘 마무리되길 바랄 뿐이다 :)<br>아 마지막으로 입학 전에 영어에 대한 공포증을 없애고 입학하고 싶네.", "desc_en": "The year 2025, which felt so long and tenacious, has finally set, and 2026—a year that seemed so distant it might never come—has dawned.<br>Last year's January 1st remains a bitter memory, but on the first day of this year, I calmly drifted to sleep, reflecting on that pain.<br><br>On January 2nd, sipping my coffee, I scrolled through my calendar. My 'Future' schedule is packed tight until 2030...<br>Even amidst that, 2026 clearly promises to be a year that will rush by breathlessly. It’s that mix of fear and excitement that comes from walking a path I’ve never trodden before.<br>Yet, one thing remains unchanged: my calendar is already saturated. Or perhaps, it has already exploded.<br>There is so much I want to do, but only one of me, forcing me to realize once again that this is the moment to coldly and decisively set priorities.<br><br>The upheaval seems likely to start right from January. I will wrap up MIT 6.0001 and embark on 6.0002.<br>As for the HND research... I just hope the draft is completed.<br>Honestly, the question of whether I—someone who hasn't even started undergraduate studies—am qualified to do research constantly haunts me.<br>I don't know. I just hope this January wraps up without incident :)<br>Oh, and lastly, I really want to conquer my phobia of English before I enter university.", "link": "#", "category": "Essay"}]}];

let activeFilter = 'all';

function generateReCards() {
    const grid = document.getElementById('reGrid');
    const lang = typeof currentLang !== 'undefined' ? currentLang : 'KR';
    
    // Flatten data for easier filtering and rendering
    const allItems = reData.flatMap(yearGroup => 
        yearGroup.items.map(item => ({...item, year: yearGroup.year}))
    );
    
    const filteredData = activeFilter === 'all' 
        ? allItems 
        : allItems.filter(item => item.year === activeFilter);

    grid.innerHTML = filteredData.map((item, idx) => `
        <div class="re-card" onclick="toggleReCard(${idx})" data-idx="${idx}">
            <div class="re-header">
                <div class="re-meta">
                    <span class="re-date">${item.date}</span>
                    <span class="re-category">${item.category || 'Essay'}</span>
                </div>
                <h3 class="re-title">${lang === 'KR' ? (item.title_kr || item.title) : (item.title_en || item.title)}</h3>
            </div>
            <div class="re-content">
                <div class="re-text">
                    ${lang === 'KR' ? item.desc_kr : item.desc_en}
                </div>
            </div>
        </div>
    `).join('');
    
    // Update filter dropdown options
    updateFilterOptions();
}

function updateFilterOptions() {
    const filterSelect = document.getElementById('reYearFilter');
    if (!filterSelect) return;
    
    // Get unique years
    const years = [...new Set(reData.map(y => y.year))].sort().reverse();
    
    // Preserve current selection or default to 'all'
    const currentVal = filterSelect.value || 'all';
    
    let html = '<option value="all">All Years</option>';
    years.forEach(year => {
        html += `<option value="${year}">${year}</option>`;
    });
    
    filterSelect.innerHTML = html;
    filterSelect.value = currentVal;
}

function filterReCards() {
    const filter = document.getElementById('reYearFilter');
    activeFilter = filter.value;
    generateReCards();
}

function toggleReCard(idx) {
    // Optional: Add expand/collapse logic here if needed
    // currently cards show content by default
}
